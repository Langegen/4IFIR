# Гайд по тонкой настройке 4IFIR WIZARD

## Советы перед настройкой
* Используйте EMUNAND
* Сделайте бекап сохранений 
* Установите игры для проверки стабильности настроек
* Текущие параметры, установленные в 4IFIR WIZARD, хранятся в файле atmosphere\kips\loader.kip
* Если после изменения какого-то из параметров перестала включаться консоль - верните предыдущее значение через safe-mode
* Если не получилось откатить изменения через safe-mode, то используйте KipTool - это payload-based инструмент, позволяющий редактировать значение параметров в вашем `loader.kip` файле.
Инструкцию по установке и использованию можно найти на [странице проекта](https://github.com/kawaii-flesh/KipTool)
* следует установить HB Menu как приложение [.nsp файл по ссылке](https://t.me/kf4fr/48074/547847). Далее все манипуляции и тесты следует проводить именно в нем.
* Для проверки параметров на стабильность, сначала запускаем - MicroMemBench. Если все ОК, то можно переходить к тестам в игре, для этого хорошо подойдет Red Dead Redemption, игра хорошо нагружает консоль.
Для большей нагрузки, можно перевести консоль в docked mode с помощью ReversNX. Для каждого теста будет достаточно 15-20 минут игры.

## 4IFIR WIZARD

### CPU
Начать рекоммендую с настроек CPU, так как CPU не зависит от RAM и GPU. Поэтому даже если вы в будующем захотите сделать себе новый кип (более экономичный или более производительный), 
то раздел CPU вап перенастраивать не придется.  
Если какой то из параметров будет "перекручен", то консоль скорее всего просто зависнет после лого атмосферы. Поэтому загружаемся в СейфМод и возвращаем параметр в предыдущее значение
***
**Переходим в 4advanced - CPU**
* CPU Minimal Voltage – выбор нижнего порога потребления процессора.   
>Чем ниже напряжение, тем меньше потребление. Выставляем его на шаг ниже (например, было 620, стало 590 мВ). Перезагружаем систему и проводим тесты.  
>Тесты проводим в играх, выставляя минимальную частоту через    
>4IFIR Miracle -> Temporary overrides -> CPU  
>Если все хорошо, опускаем напряжение еще ниже и так далее, пока система работает.     
>Фиксируем значение и оставляем его.   
* CPU Maximum Voltage – выбор верхнего порога потребления процессора.  
**Рекомендуется оставить значение eBamatic**    
>Повышаем напряжение на 1 шаг, перезагружаемся и тестируем в CPU-зависимых играх (RDR, Hogwarts Legacy, No Man's Sky) в режиме 4IFIR Maximized на CPU. Повышаем до тех пор, пока все работает. `
* dCPUv - корректировка напряжений в диапазоне частот от 12хх до 18хх MHz  
**Рекомендуется оставить значение eBamatic**
>Действовать нужно с осторожностью и на свой страх и риск. Хотя катастрофических последствий быть не должно, ошибки в работе игры и операционной системы возможны.
  Перед редактированием рекомендуется сделать бекап конфигурации, чтобы не пересоздавать ее заново. Откатить изменения в конфигураторе не получится.
  За отправную точку можно взять напряжение 780mV и затем снижать или повышать его на один шаг по мере прохождения тестов (чем меньше напряжение, тем меньше потребление).
  Обязательно протестируйте работу с разгоном оперативной памяти и отключенным CPU Freq Governor в диапазоне частот 12хх-18ххMHz в CPU-интенсивных играх!
* CPU Boost Clock – выбор частоты до которой будет разгонятся игра на загрузочных экранах.  
**Рекомендуется оставить значение eBamatic**
>Можно выставить максимальное значение, но eBamatic - стабильнее 
* Low Mhz Undervolt – уровни андервольта для частот процессора ниже <=15хх Mhz.  
>Чем выше значение, тем ниже потребление на частотах до 15ххMHz. Выставляем на шаг выше, тестируем в играх на частотах до 15ххMHz с выключенным Governor    
>4IFIR Miracle -> Edit app Profile -> CPU Freq Governor -> Off    
>Повышаем значения до тех пор пока работает.  
* High Mhz Undervolt – уровни андервольта для частот процессора выше >15хх Mhz.    
**Рекомендуется оставить значение eBamatic**  
>Чем выше значение, тем ниже потребление на частотах выше 15xxMhz. 
>Выставляем на шаг выше, тестируем в CPU зависимых играх (Metro, Hogwarts Legacy, No Man's sky) на частотах выше 15ххMHz с выключенным Governor. Повышаем до тех пор, пока все работает. Рекомендуется тестировать в режиме 4IFIR MAXIMIZED:  
>4IFIR Miracle -> Temporary overrides -> CPU -> 4IFIR MAXIMIZED
* Speed Shift - понижение напряжения (потребления) вторичных компонентов консоли. Чем выше значение, тем ниже потребление.  
 **Рекомендуется оставить значение eBamatic**
>Чем выше значение, тем ниже потребление 
>Выставляем на шаг выше, тестируем

### GPU
Далее можно перейти к настройке GPU   
Тесты можно проводить только в играх, так как MemBench не задействует GPU
Принцип работы волтажей GPU:
GPUv Min - зависит от текущей частоты RAM, но так как теперь этот параметр адаптивный, то заморачиваться на этом не стоит. (для справки)
На вольтажи GPU влияют 2 параметра - GPUv Min (1й приоритет) и Gpu Eco Mode (2й приоритет);  
От самой минимальной частоты GPU - до *xxx*MHz (это частота которую предстоит вычислить опытным путем) используются вольтажи GPUv Min  
На всех остальных частотах GPU используются вольтажи из таблицы Gpu Eco Mode  
Оибки связаные с "перекручеными" настройками GPU, обычно выглядят в виде артефактов в играх(нарушение целостности текстур, непонятные сверкающие точки, изменение текстур). Так же могут сопровождаться оранжевым экраном.
***
**Переходим в раздел SmartMode-QuickTune-GPU**
* GPUv Mode – уровни самого минимального значения потребления видеокарты.   
>Чем выше Stage, тем ниже напряжение и меньше потребление.    
>Повышаем значение на шаг и перезагружаемся. Система работает? Отлично!  
>Запускаем GPU-интенсивные игры (Astral Chain, No Man's Sky, Hogwarts Legacy).  
>Теперь мы в игре и должны узнать, до какой частоты работает наш GPU при минимальном напряжении, которое мы выставили в этом пункте. Но перед этим, для тестов, нужно отключить GPU Freq Governor: 4IFIR Miracle -> Edit app Profile -> GPU Freq Governor -> Off;  
>Устанавливаем частоту GPU: 4IFIR Miracle -> Temporary overrides -> GPU -> *xxx*MHz;  
>Можем начинать со значения 460MHz. Установили, двигаемся в 4IFIR Miracle -> Miscellaneous; Спускаемся в самый низ и фиксируем значение GPU volt: *xxx*MHz, где xxx - ваше текущее напряжение. (**Данный показатель меняется в зависимости от частоты RAM**)    
>Возвращаемся в Temporary overrides и увеличиваем частоту GPU на один шаг.  
>Проверяем напряжение GPU в Miscellaneous, повторяя эту процедуру до тех пор, пока напряжение не изменится.  
>После этого уменьшаем частоту GPU на один шаг.  
>Таким образом, мы определили максимальную частоту при минимальном напряжении.  
>Теперь можно протестировать игры на этой частоте, обязательно с включенным разгоном RAM. 5-10 минут игры в нескольких играх будет достаточно.  
>Если на каком-либо этапе повышения частоты или теста в игре происходит сбой или зависание, снижаем GPUv. Если нет - повышаем и тестируем дальше.  
* Gpu Eco Mode – выбор уровня андервольта на всей сетке частот видеокарты (чем выше тем агрессивнее андервольт).
>Чем выше значение, тем ниже потребление на частотах. Тесты в играх проводим на частотах выше тех, на которых работает GPUv Mode (Определяли в предыдущем шаге). Рекомендуется также тестировать с выключенным GPU Freq Governor, тестируя примерно 5-10 минут. Если все хорошо, повышаем GPU Eco Mode и тестируем. Если нет - понижаем.
